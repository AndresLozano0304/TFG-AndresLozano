<div id="dashboard" >
    <br> 
    <div class="row">
        <!-- USUARIOS ACTIVOS -->
        <div class="col-6 p-5">
            <div class="row align-items-center">
                <div class="col-3">
                    <p class="marcador p-1 m-1 font-weight-bold" id="activos">
                        <span class="spinner-border text-secondary" role="status"></span></p>
                </div>
                <div class="col-9" style="color: white;">
                    <h1>EMPLEADOS ACTIVOS</h1>
                </div>
            </div>
            <div class="row">
                <div class="col-1"></div>
                <div class="col-10 card p-1 m-1" id="listadoUsuariosActivos">

                </div>
                <div class="col-1"></div>
            </div>
        </div>
        <div class="col-6 p-5">
            <div class="row align-items-center">
                <div class="col-3">
                    <p class="marcador p-1 m-1 font-weight-bold" id="incidenciasActivas">
                        <span class="spinner-border text-secondary" role="status"></span></p>
                    </p>
                </div>
                <div class="col-9" style="color: white;">
                    <h1>INCIDENCIAS ACTIVAS</h1>
                </div>
            </div>
            <div class="row">
                <div class="col-1"></div>
                <div class="col-10 card p-1 m-1" id="listadoIncidenciasActivas">

                </div>
                <div class="col-1"></div>
            </div>
        </div>
    </div>
</div>

<script>
//EMPLEADOS ACTIVOS
var listadoActivos = new Tabulator("#listadoUsuariosActivos", {
      persistence:true,
      ajaxURL: "back/servidor.php", //ajax URL
      dataLoaderLoading: "Un momento!",
      progressiveLoad:"scroll",
      placeholder: "Un momento, por favor",
      ajaxConfig: "POST", //ajax HTTP request type
      ajaxParams: { personalActivo: "ok" },
      height: "500px",
      width: "80%",
      layout:"fitDataStretch",
      persistence: {
        sort: true, //persist sort
      },
      initialSort: [
        { column: "NOMBRE", dir: "asc" }, //sort by this first

      ],
      columns: [
        {
          title: "FOTO", field: "FOTO", download:false, width: 70, formatter:function(cell, formatterParams, onRendered){
            //cell - the cell component
            //formatterParams - parameters set for the column
            //onRendered - function to call when the formatter has been rendered
            foto = cell.getValue();
            if (existe(foto)){
              return "<img src='img/empleados/"+foto+"' class='fotoEmpleado' height='50px' width='50px'>";
            }else{
              return "<img src='img/empleados/generico.png' class='fotoEmpleado'  height='50px' width='50px'>";
            }
          },
        },
        {
          title: "NOMBRE", field: "NOMBRE", headerFilter: "input"
        },
        {
          title: "INICIO", width:'200', field: "HINICIO", formatter: "datetime", formatterParams: {
            inputFormat: "YYYY-MM-DD HH:mm:ss",
            outputFormat: "HH:mm",
          }
        }
      ],
    });
    //CANTIDAD
    setTimeout(function(){
        $("#activos").html(listadoActivos.getData().length);
    },1200);

    //INCIDENCIAS
    var tableIncidencias = new Tabulator("#listadoIncidenciasActivas", {
    persistence: true,
    ajaxURL: "back/servidor.php", //ajax URL
    dataLoaderLoading: "Un momento!",
    progressiveLoad: "scroll",
    placeholder: "Un momento, por favor",
    ajaxConfig: "POST", //ajax HTTP request type
    ajaxParams: { listadoIncidenciasAbiertas: "ok" },
    height: "500px",
    width: "80%",
    layout:"fitDataStretch",
    persistence: {
      sort: true, //persist sort
    },
    initialSort: [
      { column: "FECHA", dir: "desc" }, //sort by this first

    ],
    columns: [
      {
        title: "FECHA", field: "FECHA", width: 150, headerFilter: "input", headerFilter: minMaxFilterEditor, headerFilterFunc: minMaxFilterFunction, headerFilterLiveFilter: false,
        formatter: "datetime", formatterParams: {
          inputFormat: "YYYY-MM-DD",
          outputFormat: "DD-MM-YYYY",
        }
      },
      {
        title: "USUARIO", field: "USUARIO", headerFilter: "input"
      },
      {
        title: "MOTIVO", field: "MOTIVO", headerFilter: "input", width: 450
      },
    ],
  });

   //CANTIDAD
   setTimeout(function(){
        $("#incidenciasActivas").html(tableIncidencias.getData().length);
    },1200);

</script>